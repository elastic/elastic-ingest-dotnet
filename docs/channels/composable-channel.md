---
navigation_title: Configuration
---

# Channel configuration

`IngestChannel<T>` supports two configuration modes: auto-configuration from `ElasticsearchTypeContext`, and manual configuration with explicit strategies.

## Auto-configuration

When you provide an `ElasticsearchTypeContext` (generated by `Elastic.Mapping`), strategies are resolved automatically based on your entity declaration:

```csharp
var options = new IngestChannelOptions<Product>(transport, MyContext.Product.Context);
using var channel = new IngestChannel<Product>(options);
```

Auto-resolution rules:

| Entity target | Ingest | Bootstrap | Provisioning | Alias |
|---|---|---|---|---|
| `DataStream` | `DataStreamIngestStrategy` | Component + data stream templates | Always create | No alias |
| `Index` | `TypeContextIndexIngestStrategy` | Component + index templates | Hash-based reuse (if `[ContentHash]` present) | Latest + search (if aliases configured) |
| `WiredStream` | `WiredStreamIngestStrategy` | No-op | Always create | No alias |

## Manual configuration

Override any strategy for full control:

```csharp
var options = new IngestChannelOptions<MyDoc>(transport)
{
    TemplateName = "my-template",
    TemplateWildcard = "my-template-*",
    IngestStrategy = new IndexIngestStrategy<MyDoc>("my-index"),
    BootstrapStrategy = new DefaultBootstrapStrategy(
        new ComponentTemplateStep(),
        new IndexTemplateStep()
    ),
    ProvisioningStrategy = new AlwaysCreateProvisioning(),
    AliasStrategy = new NoAliasStrategy()
};
```

## Options reference

### Strategy options

| Option | Type | Description |
|--------|------|-------------|
| `TypeContext` | `ElasticsearchTypeContext?` | Source-generated context for auto-configuration |
| `IngestStrategy` | `IDocumentIngestStrategy<TEvent>?` | Controls per-document bulk operation headers and URL |
| `BootstrapStrategy` | `IBootstrapStrategy?` | Controls template and index creation |
| `ProvisioningStrategy` | `IIndexProvisioningStrategy?` | Controls whether to create or reuse indices |
| `AliasStrategy` | `IAliasStrategy?` | Controls alias management after indexing |
| `RolloverStrategy` | `IRolloverStrategy?` | Controls manual index/data stream rollover |

### Template options

| Option | Type | Description |
|--------|------|-------------|
| `TemplateName` | `string?` | Index template name |
| `TemplateWildcard` | `string?` | Wildcard pattern for index template matching |
| `GetMappingsJson` | `Func<string>?` | Function returning mappings JSON |
| `GetMappingSettings` | `Func<string>?` | Function returning analysis settings JSON |

### Lifecycle options

| Option | Type | Description |
|--------|------|-------------|
| `IlmPolicy` | `string?` | ILM policy name (self-managed only) |
| `DataStreamLifecycleRetention` | `string?` | Retention period for data stream lifecycle (for example, `"30d"`) |
| `DataStreamType` | `string?` | Data stream type (for example, `"logs"`, `"metrics"`) |

### Buffer options

Buffer behavior is configured through `BufferOptions`:

```csharp
var options = new IngestChannelOptions<MyDoc>(transport, MyContext.MyDoc.Context)
{
    BufferOptions = new BufferOptions
    {
        InboundBufferMaxSize = 500_000,
        OutboundBufferMaxSize = 5_000,
        OutboundBufferMaxLifetime = TimeSpan.FromSeconds(3),
        ExportMaxConcurrency = 8,
        ExportMaxRetries = 5
    }
};
```

See [push model](../architecture/push-model.md) for the full buffer options reference.

## Callbacks

Register callback listeners to observe channel behavior:

```csharp
var listeners = new List<IChannelCallbacks<MyDoc, BulkResponse>>
{
    new MyDiagnosticsListener()
};
var channel = new IngestChannel<MyDoc>(options, listeners);
```

Callback hooks include:
- **Inbound**: `PublishToInboundChannelSuccess`, `PublishToInboundChannelFailure`
- **Export**: `ExportItemsAttempt`, `ExportResponse`, `ExportException`
- **Retry**: `ExportRetryableCount`, `ExportRetry`, `ExportMaxRetries`

## Rollover

When a `RolloverStrategy` is configured, trigger manual rollover:

```csharp
options.RolloverStrategy = new ManualRolloverStrategy();
var channel = new IngestChannel<LogEntry>(options);

// Rollover with conditions
await channel.RolloverAsync(maxAge: "7d", maxSize: "50gb");

// Unconditional rollover
await channel.RolloverAsync();
```

See [rollover strategies](../strategies/rollover.md) and [rollover API](../index-management/rollover/rollover-api.md).

## Bootstrap

```csharp
// Throws on failure
await channel.BootstrapElasticsearchAsync(BootstrapMethod.Failure);

// Silently returns false on failure
var success = await channel.BootstrapElasticsearchAsync(BootstrapMethod.Silent);

// Skip bootstrap entirely
await channel.BootstrapElasticsearchAsync(BootstrapMethod.None);
```

Bootstrap is idempotent: if templates exist with the same content hash, the PUT operations are skipped.
